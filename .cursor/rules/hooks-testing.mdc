---
description: "Testing standards for custom hooks in this repository."
globs: test/hooks/**/*.test.ts,test/hooks/**/*.test.tsx
alwaysApply: true
---
# Testing Standards for Custom Hooks

## Language
- Tests, descriptions, and mock data must be in English.
- `it` descriptions follow: "should [expected behavior] when [condition]".
- No JSDoc in test files. Comments only if required for complex logic.

## Location and Naming
- Tests live in `test/hooks/`.
- File name: `[hook-name].test.ts` or `[hook-name].test.tsx`.

## Structure
- Use `describe` for contexts and `it` for behaviors.
- Use `beforeEach` for setup and `afterEach` for cleanup.
- Use `renderHook` and wrap state changes with `act`.

```typescript
import { act, renderHook } from "@testing-library/react/pure"
import { useHook } from "../../src/hooks/useHook"

describe("useHook", () => {
  beforeEach(() => {
    jest.clearAllMocks()
  })

  it("should return initial state when initialized", () => {
    const { result } = renderHook(() => useHook())
    expect(result.current).toEqual(expectedValue)
  })

  it("should update state when action is called", () => {
    const { result } = renderHook(() => useHook())

    act(() => {
      // perform action
    })

    expect(result.current).toEqual(expectedValue)
  })
})
```

## Async Testing
- Test loading, success, and error states.
- Clean up async operations and mocks.
- Avoid fixed timeouts when possible; prefer explicit waits for state changes.

## Mocking
- Use `jest.fn()` and verify calls.
- Reset and restore mocks in `afterEach`.

## Coverage Thresholds
- Statements: 90%
- Branches: 85%
- Functions: 90%
- Lines: 90%

## Anti-patterns
- Testing implementation details instead of behavior.
- Missing assertions.
- Not cleaning up mocks or async effects.
- Inconsistent test naming.
